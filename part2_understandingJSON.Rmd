---
title: "part2_understandingJSON"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: >
  Learn how to set up R and RStudio on your machine. We will also demonstrate
  how to install R packages from CRAN, and install the tidyverse package.
---

## 2. Understanding the Concepts
```{r 1stpic, echo=FALSE, out.width= "65%", out.extra='style="float:right; padding:10px"'}
myimg <- load.image("graphics/undraw_learning_sketching_nd4f.png")
grid.raster(myimg)
```
In this chapter we want to learn the concepts of JSON. GeoJSON, JSON-LD and GeoJSON-LD. It is important to read them carefully because the different concepts build on each other and can't be viewed individually.

```{r JSONpic, echo=FALSE, fig.align = "center", out.width="100%"}
myimg <- load.image("graphics/pexels-cottonbro-4778611.jpg")
grid.raster(myimg)
```

### JSON

#### Definition

JSON is a text-format for storing and sharing data in the web. It is developed to be understood by humans AND computers equally. The following definition is cited from www.JSON.org:
    
::: {#JSONdefinition .message}
JSON (JavaScript Object Notation) is a standardized lightweight data-interchange format. It is easy for humans to read and write. It is easy for machines to parse and generate. JSON is a text format that is completely language independent but uses conventions that are familiar to programmers of the C-family of languages, including C, C++, C#, Java, JavaScript, Perl, Python, and many others. These properties make JSON an ideal data-interchange language.

JSON is built on two structures:
A collection of name/value pairs. In various languages, this is realized as an object, record, struct, dictionary, hash table, keyed list, or associative array.
An ordered list of values. In most languages, this is realized as an array, vector, list, or sequence.

These are universal data structures. Virtually all modern programming languages support them in one form or another. It makes sense that a data format that is interchangeable with programming languages also be based on these structures.

In JSON, they take on these forms:
An object is an unordered set of name/value pairs. An object begins with "{" (left brace) and ends with "}" (right brace). Each name is followed by ":" (colon) and the name/value pairs are separated by "," (comma).
:::

Taking this definition and having a look at an example we will now try to understand the concept in a more practicable way. 
This is a JSON example showing

```json
{
    "name": "SC Europe",
    "members":[  
        {"name":"Allan", "email":"All91cutekitties@gmail.com"},  
        {"name":"Steve", "email":"Steve.Without.N@outlook.com"},  
        {"name":"Alen", "email":"alTHEman@googlemail.com"}  
    ],
    "color": "green",
    "sports":[
        "football",
        "tennis",
        "badminton",
        "tabletennis",
        "handball",
        "basketball"
    ],
    "founded": "21-01-2005"
}  
```
As you can see, the example is easy to read and understand. Just a quick question: What do you think is this JSON-file storing? Probably no ticket-system or a bar's menu. It is not always said that with reading the JSON-file you will understand exactly what the data is about and what it is used for, especially when the stored data gets more abstract. For example it is not very clear what is meant by color at this point. It might describe the lead color of the club but we do not now that from the data. Still, you mostly could get a first impression of the data by having a glimpse at the file itself.

#### Setting up a JSON-file
What do we see in the example?
First, we can see, that the object is, as defined before, wrapped in {}. Then, we see that the object has multiple attributes that have a specific name and a value both in "" and divided by :. The left side of the colon shows the name of the attribute while the right side shows the value. We can see, that a value can be a list (an array) of values enclosed by [] and that a value can also be an object itself. Do you see that the attribute "members" has an array of objects as value?

Lets have a quick and simple task to get hands on JSON yourself:
In the following codeblock you can write the JSON file as the following tasks wants you to 

:::{#luigisTask .task-message .panel}
:::{.panel-body}
Write a valid JSON file that reflects the following description: 
The JSON-file should describe a restaurant, that is called Pizza Luigi, and that stores their dishes: the first one is pizza (obviously), the second one pasta (what else) and the third one is tiramisu (delizioso). If you are done check the sollution. Additionally, there are some properties stored for the dishes: The price (pizza costs 7€, pasta 6 and tiramisu 10 because it is one of the best), the information, if it is also available as vegan dish (pizza not, pasta is and tiramisu also can be ordered vegan).

```{json taskLuigi, exercise = TRUE}

```
```{json taskLuigi-solution}
{
    "name":"Pizza Luigi",
    "dishes":[
        {"name":"pizza","price":"7","vegan_option":"false"},
        {"name":"pasta","price":"6","vegan_option":"true"},
        {"name":"tiramisu","price":"10","vegan_option":"true"}
     ]
}
```
<div id="taskLuigi-hint">
**Hint:** Objects can be in a list and a value for a properties.
</div>

:::
:::

### Accessing JSON-files and their values

We now saved the SC Europe JSON to a file, and we can load it with `R` using the `rjson` package that we installed before and loaded it in this project with `library(rjson)`. Now we can acccess the json file and save it to a variable.

```{r workingJSON, include=TRUE}
sceurope <- fromJSON(file = "./data/scEurope.json")
```

Now it is your turn to access this files information. Can you access and print ONLY Steve's email-address with the help of those two commands! The accessing of values from JSON in `R` is different than using `Javascript`, because the `rjson` parser is converting the JSON into a R object.

```{r accessingSCEurope, exercise=TRUE}
print(sceurope)
print(sceurope$founded)
```
```{r accessingSCEurope-solution}
print(sceurope$members[[2]]$email)
```
<div id="accessingSCEurope-hint">
**Hint:** Have a look at the plot of the whole JSON. There might be hints of how `R` structures the data. 
</div>

If you need any further information or want to dig deeper into the JSON-format www.JSON.org is a good starting point for you.

```{r quiz_json, echo=FALSE}
quiz(caption = "Quiz - JSON",
  question("JSON stands for...",
    answer("Java Static Online Notation", message = "Sure?"),
    answer("JavaScript Object Notation", correct = TRUE, "Correct answer"),
    answer("Java Standartizised Object Notation", message = "Do you think this has something to do with Java?" ),
    allow_retry = TRUE
  ),
    question("Is it legal to have nested JSON objects?",
    answer("Yes",correct = TRUE, "As seen, an object can be the value of a property of another object"),
    answer("No", message="As seen, an object can be the value of a property of another object"),
    allow_retry = TRUE
  ),
    question("Can we dynamically access JSON-files?",
    answer("No, we can't", message = "Take a look at the tasks above, one more time."),
    answer("Yes, we can!", correct = TRUE, "And this is the awesome part about JSON!"),
    allow_retry = TRUE
  )
)
```


### GeoJSON
GeoJSON is a format for encoding a variety of geographic data structures. It is a specification of JSON. Additional to the JSON rules there are some more that defines a GeoJSON. A GeoJSON has to have a 'type' attribute than can be a value of these: [Point, MultiPoint, LineString, MultiLineString, Polygon, MultiPolygon, GeometryCollection, Feature, FeatureCollection]. Furthermore the position is important for a GeoJSON where coordinates are alway given in WGS84 due to the fact that other CRS harm the interoperability of the GeoJSON.

An example for a GeoJSON can be seen in the next examples. The first one shows a valid point and the second one a feature with a geometry that is also a point. The difference lays in the structure and the additional information that are included.

```json
{
    "type": "Point",
    "coordinates": [125.6, 10.1]
}

{
  "type": "Feature",
  "geometry": {
    "type": "Point",
    "coordinates": [125.6, 10.1]
  },
  "properties": {
    "name": "Dinagat Islands"
  }
}

```

Another example shows a regular MultiPolygon. It has multiple arrays of points that are also saved inside of arrays. At this point it is important to keep track of the brackets to get not confused and give the computer wrong information about the given JSON.

```json
    {
         "type": "MultiPolygon",
         "coordinates": [
             [
                 [
                     [102.0, 2.0],
                     [103.0, 2.0],
                     [103.0, 3.0],
                     [102.0, 3.0],
                     [102.0, 2.0]
                 ]
             ],
             [
                 [
                     [100.0, 0.0],
                     [101.0, 0.0],
                     [101.0, 1.0],
                     [100.0, 1.0],
                     [100.0, 0.0]
                 ],
                 [
                     [100.2, 0.2],
                     [100.2, 0.8],
                     [100.8, 0.8],
                     [100.8, 0.2],
                     [100.2, 0.2]
                 ]
             ]
         ]
     }

```


POSSIBLE QUESTIONS AT THE END:
what do we see in a code snipped 
what is legal or illigal with geojson 

If you would like to see the official definition of GeoJSON you may have [a look at this page](https://datatracker.ietf.org/doc/html/rfc7946).

TODO: NOCHMAL DETAILIERTER BESCHREIBEN UND SCHRITT FÜR SCHRITT ERKLÄREN WIE NE GEOJSON AUFGEBAUT IST

### JSON-LD

What is 'Linked Data'
![](https://youtu.be/4x_xzT5eF5Q)

Linked Data Signature
![](https://youtu.be/QdUZaYeQblY)

What is JSON-LD
![](https://youtu.be/vioCbTo3C-4)

JSON-LD Basic Markup
![](https://youtu.be/UmvWk_TQ30A)

JSON-LD Compaction and Expansion
![](https://youtu.be/Tm3fD89dqRE)

TODO: NOCHMAL DETAILIERTER BESCHREIBEN UND SCHRITT FÜR SCHRITT ERKLÄREN WIE NE JSON-LD AUFGEBAUT IST

### GeoJSON-LD



```{r addition, exercise=TRUE}
1 + 1
```




```{r quiz2, echo=FALSE}
quiz(caption = "Quiz - Install R",
  question("Is R free to download and use?",
    answer("Yes!", correct = TRUE, message = "R is free _and_ open source, which means that anyone can read, use, and copy the source code of the R language."),
    answer("No.")
  ),
  question("Where do you download R?",
    answer("www.rstudio.com/download"),
    answer("[cloud.r-project.org](http://cloud.r-project.org)", correct = TRUE, message = "You can also download R from [cran.r-project.org](http://cran.r-project.org)"),
    answer("www.r-project.org", message = "Good try, but not exactly. www.r-project.org doesn't provide a download link, but it does provide a link to one the websites above."),
    answer("www.r.com"),
    allow_retry = TRUE
  ),
  question("How often should you update R?",
    answer("Everytime you use it", message = "This will be too often unless you use R very rarely!"),
    answer("About once a year", correct = TRUE, "A new version of R is released about once a year. Update sooner if you encounter a bug that you cannot explain."),
    answer("Never", message = "A new version of R is released about once a year. I'll assume that you are using the newest version of R, which will be the fastest version with the fewest unexpected behaviors." ),
    allow_retry = TRUE
  )
)
```

TODO: NOCHMAL DETAILIERTER BESCHREIBEN UND SCHRITT FÜR SCHRITT ERKLÄREN WIE NE GEOJSON-LD AUFGEBAUT IST

### Exercise

Answer the question. Multiple answers can be true.
```{r where-am-i, echo=FALSE}
question("What is true about GeoJSON?",
  answer("GeoJSON uses the JavaScript Object Notation.", correct = TRUE),
  answer("GeoJSON can not be used without JSON-LD processing."),
  answer("Something true", correct = TRUE),
  answer("Something true", correct = TRUE),
    random_answer_order = TRUE,
  incorrect = "Incorrect. You're on Earth, in the Milky Way, at a computer."
)
```


The following GeoJSON file got some mistakes. Can you hunt them down to run the code correctly?
```{r exercise1, exercise = TRUE}
result <- fromJSON('{
         "type": "MultiPolygon",
         "coordinates": [
             [
                     [102.0, 2.0],
                     [103.0, 2.0],
                     [103.0, 3.0],
                     [102.0, 3.0],
                     [102.0, 2.0]
             ],
             [
                 [
                     [100.0, 0.0],
                     [101.0, 0.0],
                     [101.0, 1.0],
                     [100.0, 1.0],
                     [100.0, 0.0]
                
         ]
     }')

```

```{r exercise2, exercise = TRUE}

spdf <- geojson_read('PUT IN A URL OT A GEOJSON FILE THAT MIGHT BE INTERESTING',  what = "sp")

par(mar=c(0,0,0,0))
plot(spdf_region_6, col="grey")
```
 
